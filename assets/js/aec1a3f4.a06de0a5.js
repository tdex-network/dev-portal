"use strict";(self.webpackChunkdev_portal=self.webpackChunkdev_portal||[]).push([[9183],{3522:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var r=t(8168),n=(t(6540),t(5680));const o={title:"Market Account",sidebar_position:6},s=void 0,i={unversionedId:"provider/daemon/market_account",id:"version-1.0.0/provider/daemon/market_account",title:"Market Account",description:"A market from the Ocean wallet's POV is just one of the many HD accounts that can be created, like the fee one or the fragmenters.",source:"@site/versioned_docs/version-1.0.0/provider/daemon/market_account.md",sourceDirName:"provider/daemon",slug:"/provider/daemon/market_account",permalink:"/docs/v1/provider/daemon/market_account",draft:!1,editUrl:"https://github.com/tdex-network/dev-portal/edit/master/versioned_docs/version-1.0.0/provider/daemon/market_account.md",tags:[],version:"1.0.0",sidebarPosition:6,frontMatter:{title:"Market Account",sidebar_position:6},sidebar:"version-1.0.0/tutorialSidebar",previous:{title:"Fee Account",permalink:"/docs/v1/provider/daemon/fee_account"},next:{title:"Fee Fragmenter Account",permalink:"/docs/v1/provider/daemon/fee_fragmenter_account"}},l={},d=[{value:"Create a market",id:"create-a-market",level:2},{value:"Deposit funds",id:"deposit-funds",level:2},{value:"List all derived addresses",id:"list-all-derived-addresses",level:2},{value:"Get market info",id:"get-market-info",level:2},{value:"Change the percentage fees",id:"change-the-percentage-fees",level:2},{value:"Change the fixed fees",id:"change-the-fixed-fees",level:2},{value:"Change the strategy",id:"change-the-strategy",level:2},{value:"Change the price",id:"change-the-price",level:2},{value:"Open a market",id:"open-a-market",level:2},{value:"Get trading report",id:"get-trading-report",level:2},{value:"Close a market",id:"close-a-market",level:2},{value:"Withdraw funds",id:"withdraw-funds",level:2},{value:"Drop a market",id:"drop-a-market",level:2}],c={toc:d},p="wrapper";function u(e){let{components:a,...t}=e;return(0,n.yg)(p,(0,r.A)({},c,t,{components:a,mdxType:"MDXLayout"}),(0,n.yg)("p",null,"A market from the Ocean wallet's POV is just one of the many HD accounts that can be created, like the fee one or the fragmenters."),(0,n.yg)("p",null,"Meanwhile, from the provider's POV a market is a collection of the following metadata:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"base and quote asset pair, and their precisions - for example LBTC/USDT both with precision 8"),(0,n.yg)("li",{parentName:"ul"},"fees - percentage and fixed fees set for the base and/or quote asset"),(0,n.yg)("li",{parentName:"ul"},"tradable - whether the market is open or closed to public trading"),(0,n.yg)("li",{parentName:"ul"},"strategy - whether AMM or with price provided by a price feed"),(0,n.yg)("li",{parentName:"ul"},"price - only for markets without AMM strategy")),(0,n.yg)("p",null,"These are all the properties you can define for every market you create, some of them are also customizable during their lifetime. Here you'll learn how to manage your markets."),(0,n.yg)("h2",{id:"create-a-market"},"Create a market"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"$ tdex market create \\\n  --base-asset 144c654344aa716d6f3abcc1ca90e5641e4e2a7f633bc09fe3baf64585819a49 \\\n  --quote-asset f3d1ec678811398cd2ae277cbe3849c6f6dbd72c74bc542f7c4b11ff0e820958 \\\n  --base-asset-precision 8 --quote-asset-precision 8 \\\n  --name lbtc_usdt \\\n  --percentage-base-fee 200 --percentage-quote-fee 100 \\\n  --fixed-base-fee 700 --fixed-quote-fee 1000000 \\\n  --strategy BALANCED\n")),(0,n.yg)("p",null,"When you create a market you can pretty much define all its properties with some exceptions: once a market is created, you can't change its base or quote asset, nor its name."),(0,n.yg)("p",null,"If you don't provide a name, one will be assigned automatically as the hash of the asset pair. You can't create a market with an existing asset pair or name."),(0,n.yg)("p",null,"Here below you can learn how to fully manage your markets, but before digging into the other commands, let's configure the CLI so that it refers to the one we have just created:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"$ tdex config set base_asset 144c654344aa716d6f3abcc1ca90e5641e4e2a7f633bc09fe3baf64585819a49\n$ tdex config set quote_asset f3d1ec678811398cd2ae277cbe3849c6f6dbd72c74bc542f7c4b11ff0e820958\n")),(0,n.yg)("p",null,"All the commands that follow require both\xa0",(0,n.yg)("inlineCode",{parentName:"p"},"base_asset")," and ",(0,n.yg)("inlineCode",{parentName:"p"},"quote_asset")," to be set in your CLI's config file. If you have created multiple markets and you need to switch between them, it's enough to change base and/or quote asset with the ",(0,n.yg)("inlineCode",{parentName:"p"},"tdex config set")," command."),(0,n.yg)("h2",{id:"deposit-funds"},"Deposit funds"),(0,n.yg)("p",null,"Just like any other account, let's derive some new addresses to deposit base/quote asset funds to the market:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"$ tdex market deposit --num-of-addresses 2\n")),(0,n.yg)("p",null,"Here we generated 2 addresses, one for receiving LBTCs, the other for USDTs to prevent address reuse. Once the funds are sent, you'll have to wait for them to be confirmed, in the meanwhile you can setup your market with the commands below."),(0,n.yg)("h2",{id:"list-all-derived-addresses"},"List all derived addresses"),(0,n.yg)("p",null,"You can see the list of all the derived addresses so far with:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"$ tdex market addresses\n")),(0,n.yg)("h2",{id:"get-market-info"},"Get market info"),(0,n.yg)("p",null,"You can take a look at your market configuration with:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"$ tdex market info\n")),(0,n.yg)("p",null,"This commands shows you also the current balance, and the price (if not AMM strategy), so this is the one that lets you know if the funds are eventually confirmed during the deposit phase."),(0,n.yg)("h2",{id:"change-the-percentage-fees"},"Change the percentage fees"),(0,n.yg)("p",null,"You can change the percentage fees that your market takes from every trade. You can set a different fee on the base and the quote assets. It is expressed in ",(0,n.yg)("em",{parentName:"p"},"basis_point")," and can assume values in the range ",(0,n.yg)("inlineCode",{parentName:"p"},"[0, 9999]")," which means from 0.00% (no fees) up to 99.99%: "),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"# Update fees for both assets\n$ tdex market percentagefee --base-fee 500 --quote-fee 400\n\n# Update fees for base asset only\n$ tdex market percentagefee --base-fee 500\n\n# Update fees for quote asset only\n$ tdex market percentagefee --quote-fee 400\n")),(0,n.yg)("h2",{id:"change-the-fixed-fees"},"Change the fixed fees"),(0,n.yg)("p",null,"Similarly, you can change the fixed fees, ie. a specific amount defined on base and/or quote assets taken from trades. This value is expressed in satoshis and must be equal or greater than ",(0,n.yg)("inlineCode",{parentName:"p"},"0"),":"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"# Update fees for both assets, 700sats on LBTC and 0.01$ on USDT\n$ tdex market fixedfee --base-fee 700 --quote-fee 1000000\n\n# Update fees for base asset only\n$ tdex market fixedfee --base-fee 700\n\n# Update fees for quote asset only\n$ tdex market fixedfee --quote-fee 1000000\n")),(0,n.yg)("h2",{id:"change-the-strategy"},"Change the strategy"),(0,n.yg)("p",null,"You can change the market strategy, that affects the way the way the price and previews are calculated."),(0,n.yg)("p",null,"The provider supports 2 strategies:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("em",{parentName:"li"},"balanced")," - AMM strategy that calculates prices and previews by applying the constant-product formula. With this strategy, price and previews depend on the base and quote asset balances."),(0,n.yg)("li",{parentName:"ul"},(0,n.yg)("em",{parentName:"li"},"pluggable")," - not AMM strategy. This strategy requires you to manually provide a price for your market like showed in the following section. In this case, you might want to ",(0,n.yg)("a",{parentName:"li",href:"/docs/v1/provider/daemon/feeder"},"setup a feeder")," to feed your market with prices provided by an external exchange like for example bitfinex or kraken.")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"# Update strategy to balanced AMM\n$ tdex market strategy --balanced\n\n# Update strategy to pluggable\n$ tdex market strategy --pluggable\n")),(0,n.yg)("h2",{id:"change-the-price"},"Change the price"),(0,n.yg)("p",null,"Only if you set up a ",(0,n.yg)("em",{parentName:"p"},"pluggable")," strategy for your market, you can manually set its price with:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"$ tdex market price --base-price 0.00003334 --quote-price 30000\n")),(0,n.yg)("h2",{id:"open-a-market"},"Open a market"),(0,n.yg)("p",null,"Once you're good with your market configuration and the funds are confirmed, you can open your market so traders can start trading on it:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"$ tdex market open\n")),(0,n.yg)("h2",{id:"get-trading-report"},"Get trading report"),(0,n.yg)("p",null,"You can get a report of the trading activity of your market in a certain time period. This reports includes info like the trading volume and the total amount earned (collected fees)."),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},'# Get report for a predefined period\n# Check all available predefined periods with tdex market report --help\n$ tdex market report --last-day\n\n#\xa0Get report for a custom period.\n# Dates must be expressed in RFC3339 format \n$ tdex market report --start "2023-01-02T00:00:00Z" --end "2023-01-30T23:59:00Z"\n')),(0,n.yg)("h2",{id:"close-a-market"},"Close a market"),(0,n.yg)("p",null,"Sometimes you may need to put your market on pause - not allow any trade against it - becuase for example you want to change the market strategy or update the fees, or even because you want to deposit or withdraw funds from it. You can do that with:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"$ tdex market close\n")),(0,n.yg)("h2",{id:"withdraw-funds"},"Withdraw funds"),(0,n.yg)("p",null,"You can withdraw funds from your market to some receiver(s) with:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},'# Withdraw 500k sats of LBTC and 50$\n$ tdex market withdraw \\\n  --password password \\\n  --receivers \'[{"asset": "144c654344aa716d6f3abcc1ca90e5641e4e2a7f633bc09fe3baf64585819a49", "amount": 500000, "address": "tex1qr34j6jpqfkct6a2qtu77jn4fqsnxgc2hstk6wq"}, {"asset": "f3d1ec678811398cd2ae277cbe3849c6f6dbd72c74bc542f7c4b11ff0e820958", "amount": 5000000000 , "address": "vjTyPZRBt2WVo8nnFrkQSp4x6xRHt5DVmdtvNaHbMaierD41uz7fk4Jr9V9vgsPHD74WA61Ne67popRQ"}]\'\n')),(0,n.yg)("h2",{id:"drop-a-market"},"Drop a market"),(0,n.yg)("p",null,"You can even decide to drop your market. This requires you to withdraw all funds from it in advance:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-bash"},"$ tdex market drop\n")),(0,n.yg)("p",null,"Awesome! You've learned how to manage your markets. You learned almost everything if you went so far, but you still may don't know that you can ",(0,n.yg)("a",{parentName:"p",href:"/docs/v1/provider/daemon/webhooks"},"setup webhooks")," to be always aware of what's happening with your provider. Or that you can now ",(0,n.yg)("a",{parentName:"p",href:"/docs/v1/provider/daemon/feeder"},"setup a price feed")," for your market!"),(0,n.yg)("p",null,"Your market is now ready for trading. It is finally time to ",(0,n.yg)("a",{parentName:"p",href:"/docs/v1/provider/registry"},"announce your provider to the public")," so that traders can start trading against it!"))}u.isMDXComponent=!0},5680:(e,a,t)=>{t.d(a,{xA:()=>c,yg:()=>g});var r=t(6540);function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function o(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){n(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function i(e,a){if(null==e)return{};var t,r,n=function(e,a){if(null==e)return{};var t,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var l=r.createContext({}),d=function(e){var a=r.useContext(l),t=a;return e&&(t="function"==typeof e?e(a):s(s({},a),e)),t},c=function(e){var a=d(e.components);return r.createElement(l.Provider,{value:a},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},m=r.forwardRef((function(e,a){var t=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=d(t),m=n,g=p["".concat(l,".").concat(m)]||p[m]||u[m]||o;return t?r.createElement(g,s(s({ref:a},c),{},{components:t})):r.createElement(g,s({ref:a},c))}));function g(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var o=t.length,s=new Array(o);s[0]=m;var i={};for(var l in a)hasOwnProperty.call(a,l)&&(i[l]=a[l]);i.originalType=e,i[p]="string"==typeof e?e:n,s[1]=i;for(var d=2;d<o;d++)s[d]=t[d];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"}}]);